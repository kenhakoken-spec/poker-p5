# テキサスホールデム 6-max テスト仕様書

## 概要

本仕様書は、poker3 アプリケーションのポーカーロジックがテキサスホールデム 6-max のルールに正確に従っているかを検証するためのテスト観点を定義します。

## テスト対象

- **ロジック**: HandContext, potUtils, bettingUtils, pokerUtils
- **記録フロー**: ヒーロー選択 → ポジション選択 → アクション → 結果の整合
- **Gemini 連携**: エクスポート + コピー + 起動

## テストカテゴリ

### 1. 初期化

- 初期ポットは 1.5BB（SB 0.5BB + BB 1BB）
- 全プレイヤーのスタックは 100BB
- プリフロップは UTG から開始
- ポストフロップは SB から開始
- heroPosition と heroHand が正しく保存される

### 2. プリフロップ

- アクション順序: UTG → MP → CO → BTN → SB → BB
- ベットサイズ: Bet-relative (2x, 3x, all-in)
- 最初のアクション: 2x, 3x, all-in が選択可能
- ベット/レイズに対するアクション: 2x, 3x, all-in が選択可能
- 全員フォールドでハンド終了
- 1人残りでハンド終了（次のストリートに進まない）

### 3. ポストフロップ（Flop/Turn/River）

- アクション順序: SB → BB → UTG → MP → CO → BTN
- 最初のアクション: Pot-relative (1/3, 1/2, pot, all-in)
- ベット/レイズに対するアクション: Bet-relative (2x, 3x, all-in)
- チェック-チェックで次のストリートへ
- ベット-コールで次のストリートへ
- 全員フォールドでハンド終了
- リバー完了でハンド終了

### 4. ポット計算

- 初期ポット: 1.5BB
- ベット/レイズ/オールイン: 指定額をポットに追加
- コール: 現在のベット額に合わせてポットに追加
- ストリートごとのポット計算が正確

### 5. ストリート進行

- ラウンドが閉じたときのみ次のストリートへ
- 全員チェックで次のストリートへ
- 最後のアグレッサーに手番が戻り、全員がコール/フォールドで次のストリートへ
- 1人残り（全員フォールド）の場合はハンド終了（次のストリートに進まない）

### 6. ハンド終了条件

- 1人残り（全員フォールド）でハンド終了
- リバー完了でハンド終了
- 全員オールインでストリートを進め、リバーまで（またはショーダウン）でハンド終了

### 7. アクション可否

- チェック可能: 現在のベット額に既にマッチしている場合
- コール可能: スタックが現在のベット額以上の場合
- ベット/レイズ可能: スタックが0より大きい場合
- フォールド: 常に可能（ただしチェック可能な場合はフォールド不可）

### 8. 最小レイズ

- 最初のベット: 最小2BB
- レイズ: 最後のベット/レイズ額の2倍が最小レイズ

### 9. BBオプション（全員リンプ時）

- 全員がコール（リンプ）した場合、BBはチェック可能
- BBはチェックまたはレイズ可能

### 10. マルチウェイポット

- 3人以上がアクティブな場合のアクション順序
- 各プレイヤーが正しい順序でアクション可能

### 11. ヘッズアップ（2人）

- 2人だけがアクティブな場合のアクション順序
- ポストフロップは BB が先手

### 12. オールイン

- 全プレイヤーがオールイン時は自動スキップ
- オールイン時のポット計算
- オールイン時のストリート進行

### 13. 記録フロー

- ヒーロー選択 → ポジション選択 → アクション → 結果の一連の状態遷移
- heroPosition と heroHand が正しく保存される
- アクション履歴が正しく記録される

### 14. Gemini 連携

- エクスポート形式の妥当性
- コピー内容の正確性
- 起動用 URL/スキームのテスト

## テストパターン数

約200パターンを目標とし、上記カテゴリの組み合わせで網羅的にテストします。
